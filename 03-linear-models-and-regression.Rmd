---
title: "Joshua French"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output: html_notebook
---

# Linear models and regression

## Regression models

Regression models are used to model the relationship between:

* a single variable $Y$, called the *response*, *outcome*, *output*, or *dependent* variable.
* one or more *predictor*, *input*, *independent*, *explanatory*, or *feature* variables.

Note:  the descriptions of independent and dependent variables are vague and are best avoided.

A distinction is sometimes made between *regression* and *classification* models. In that case:

* Regression models attempt to predict the numerical response.
* Classification models attempt to predict the category level a response will have.

A *linear model* is a regression model in which the regression coefficients (to be discussed later) enter the model linearly.

  * A linear model is just a specific type of regression model.

## Common types of regression models

* *Simple* regression model: a regression model with one constant predictor and one non-constant predictor. 
* *Multiple* regression model: a regression model with more than one non-constant predictor.
* *Multivariate* regression model: a regression model with more than one response variable.
* *Linear* regression model: a regression model in which the regression coefficients enter the model linearly.
* *Analysis of variance (ANOVA)* model: a linear regression model with one or more categorical predictors.
* *Analysis of covariance (ANCOVA)*: a linear regression model with a quantitative predictor and a categorical predictor.
* *Generalized linear model (GLM)*: a type of "generalized" regression model when the responses do not come from a normal distribution.

## Basic assumptions of linear models

The most basic assumptions of linear regression models:

* The response variable $Y$ is continuous.
* The regression coefficients enter the model linearly.

Predictors can be continuous, discrete, or categorical.

## Goals of regression

1. Prediction of future or unseen responses given specified values of the predictors.
2. Assessments of the effect of, or relationship between, explanatory variables and the response.  We would like to infer causal relationships if possible.

Be clear of your objective!  Your choice of analysis may differ depending on the objective.

There is no such thing as a "true model" for real data.

We want to find a model that adequately describes the relationship between the response and relevant predictor variables, allows us to make good predictions, infer causality, etc.

## Scatter plots and linear regression

Scatter plots are a convenient way to study the potential relationship between a single response and a single predictor variable.

### Height inheritability

Karl Pearson (1857-1936) organized the collection of $n=1375$ heights of mothers in the United Kingdom under the age of 65 and one of their adult daughters over the age of 18.  These data are available in the `Heights` data set in the **alr4** package. We are interested in the inheritance from the mother to the daughter, so the mother’s height (`mheight`) is used as the predictor variable and the daughter’s height (`dheight`) is used as the response variable.

Questions of interest:

* Do taller mothers tend to have taller daughters
* Do shorter mothers tend to have shorter daughters?

```{r}
data(Heights, package = "alr4")
str(Heights)
plot(dheight ~ mheight, data = Heights,
     xlab = "mother's height (in)",
     ylab = "daughter's height (in)",
     xlim = c(55, 75), ylim = c(55, 75))
```
There seems to be a clear trend between mother's heights and daughter's heights. The taller the mother, the taller the daughter *tends* to be.

### Predicting snowfall

The `ftcollinssnow` data set in the **alr4** package measures late (September 1st until December 31st) and early (January 1st to June 30th) season snowfall for Fort Collins, CO between Late 1900 and Early 1993.

Question of interest: Can late season snowfall predict snowfall in the early part of the next year?


```{r}
data("ftcollinssnow", package = "alr4") # load data
str(ftcollinssnow) # examine structure
plot(Late ~ Early, data = ftcollinssnow) # plot data
# add "line of best fit"
abline(lm(Late ~ Early, data = ftcollinssnow), lty = 2)
# sample mean line
abline(mean(ftcollinssnow$Late), 0)
```

A plot of the snowfall data for the two time periods suggest that this relationship is weak or they may be uncorrelated.  
* The dashed line indicates the "linear of best fit" , while the solid line indicates the average of the Late snowfall.

### Turkey growth
Pens of turkeys were fed the same diet, except that each pen was supplemented with a `Dose` of amino acid methionine as a percentage of the total diet of the birds. The amino acid methionine was provided using three different `Source`s (one standard and two experimental). The `Weight` gain (g) of the turkeys was measured. These data are available in the `turkey` data in the **alr4** package.

Questions of interest:

* Is there a relationship between weight gain of the turkeys and the dose amount? If so, is the relationship linear?
* Does the source of the methionine impact the weight gain of the turkeys?

Consider a plot of the average `Weight` gain (g) of the turkeys as a function of the `Dose` amount (% of diet), separating the groups by the `Source` of the methionine.

```{r}
data(turkey, package = "alr4")
str(turkey)
summary(turkey) # the source factor (S) is not a factor
turkey$S = factor(turkey$S)
levels(turkey$S) <- c("control", "new source a", "new source b")
names(turkey) <- c("Dose", "Gain", "Source", "Replications", "SD") # rename variables
# create turkey data ggplot
library(ggplot2) # load ggplot2 package
gg_turkey <- ggplot(turkey,
                    mapping = aes(x = Dose, y = Gain,
                                  color = Source, shape = Source))
gg_turkey + geom_point() + geom_line()
```

Weight gain increases with dose amount, but doesn’t appear to be linear.

The amino acid source may slightly affect the growth trajectory of the turkeys.

An alternative version of the previous plot using the **lattice** package

```{r}
library(lattice) # load lattice package
xyplot(Gain ~ Dose, data = turkey, groups = Source,
       auto.key = TRUE, type = "b")
```