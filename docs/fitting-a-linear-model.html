<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Fitting a linear model | Joshua French</title>
  <meta name="description" content="A collection of R notebooks demonstrating how to perform data analysis with linear regression." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Fitting a linear model | Joshua French" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A collection of R notebooks demonstrating how to perform data analysis with linear regression." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Fitting a linear model | Joshua French" />
  
  <meta name="twitter:description" content="A collection of R notebooks demonstrating how to perform data analysis with linear regression." />
  

<meta name="author" content="Chapter 6 Fitting a linear model | Joshua French" />


<meta name="date" content="2021-09-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-model-definition-and-properties.html"/>
<link rel="next" href="interpreting-a-fitted-linear-model.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis with Linear Regression</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminaries</a></li>
<li class="chapter" data-level="1" data-path="r-foundations.html"><a href="r-foundations.html"><i class="fa fa-check"></i><b>1</b> R Foundations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-foundations.html"><a href="r-foundations.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.2" data-path="r-foundations.html"><a href="r-foundations.html#where-to-get-r-and-r-studio-desktop"><i class="fa fa-check"></i><b>1.2</b> Where to get R (and R Studio Desktop)</a></li>
<li class="chapter" data-level="1.3" data-path="r-foundations.html"><a href="r-foundations.html#r-studio-layout"><i class="fa fa-check"></i><b>1.3</b> R Studio Layout</a></li>
<li class="chapter" data-level="1.4" data-path="r-foundations.html"><a href="r-foundations.html#running-code-scripts-and-comments"><i class="fa fa-check"></i><b>1.4</b> Running code, scripts, and comments</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="r-foundations.html"><a href="r-foundations.html#example"><i class="fa fa-check"></i><b>1.4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-foundations.html"><a href="r-foundations.html#packages"><i class="fa fa-check"></i><b>1.5</b> Packages</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="r-foundations.html"><a href="r-foundations.html#example-1"><i class="fa fa-check"></i><b>1.5.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-foundations.html"><a href="r-foundations.html#getting-help"><i class="fa fa-check"></i><b>1.6</b> Getting help</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="r-foundations.html"><a href="r-foundations.html#example-2"><i class="fa fa-check"></i><b>1.6.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-foundations.html"><a href="r-foundations.html#data-types-and-structures"><i class="fa fa-check"></i><b>1.7</b> Data types and structures</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="r-foundations.html"><a href="r-foundations.html#basic-data-types"><i class="fa fa-check"></i><b>1.7.1</b> Basic data types</a></li>
<li class="chapter" data-level="1.7.2" data-path="r-foundations.html"><a href="r-foundations.html#other-important-object-types"><i class="fa fa-check"></i><b>1.7.2</b> Other important object types</a></li>
<li class="chapter" data-level="1.7.3" data-path="r-foundations.html"><a href="r-foundations.html#data-structures"><i class="fa fa-check"></i><b>1.7.3</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="r-foundations.html"><a href="r-foundations.html#assignment"><i class="fa fa-check"></i><b>1.8</b> Assignment</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="r-foundations.html"><a href="r-foundations.html#example-3"><i class="fa fa-check"></i><b>1.8.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="r-foundations.html"><a href="r-foundations.html#vectors"><i class="fa fa-check"></i><b>1.9</b> Vectors</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="r-foundations.html"><a href="r-foundations.html#creation"><i class="fa fa-check"></i><b>1.9.1</b> Creation</a></li>
<li class="chapter" data-level="1.9.2" data-path="r-foundations.html"><a href="r-foundations.html#creating-patterned-vectors"><i class="fa fa-check"></i><b>1.9.2</b> Creating patterned vectors</a></li>
<li class="chapter" data-level="1.9.3" data-path="r-foundations.html"><a href="r-foundations.html#example-4"><i class="fa fa-check"></i><b>1.9.3</b> Example</a></li>
<li class="chapter" data-level="1.9.4" data-path="r-foundations.html"><a href="r-foundations.html#example-5"><i class="fa fa-check"></i><b>1.9.4</b> Example</a></li>
<li class="chapter" data-level="1.9.5" data-path="r-foundations.html"><a href="r-foundations.html#categorical-vectors"><i class="fa fa-check"></i><b>1.9.5</b> Categorical vectors</a></li>
<li class="chapter" data-level="1.9.6" data-path="r-foundations.html"><a href="r-foundations.html#example-6"><i class="fa fa-check"></i><b>1.9.6</b> Example</a></li>
<li class="chapter" data-level="1.9.7" data-path="r-foundations.html"><a href="r-foundations.html#extracting-parts-of-a-vector"><i class="fa fa-check"></i><b>1.9.7</b> Extracting parts of a vector</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="r-foundations.html"><a href="r-foundations.html#helpful-functions"><i class="fa fa-check"></i><b>1.10</b> Helpful functions</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="r-foundations.html"><a href="r-foundations.html#general-functions"><i class="fa fa-check"></i><b>1.10.1</b> General functions</a></li>
<li class="chapter" data-level="1.10.2" data-path="r-foundations.html"><a href="r-foundations.html#example-7"><i class="fa fa-check"></i><b>1.10.2</b> Example</a></li>
<li class="chapter" data-level="1.10.3" data-path="r-foundations.html"><a href="r-foundations.html#functions-related-to-statistical-distributions"><i class="fa fa-check"></i><b>1.10.3</b> Functions related to statistical distributions</a></li>
<li class="chapter" data-level="1.10.4" data-path="r-foundations.html"><a href="r-foundations.html#example-8"><i class="fa fa-check"></i><b>1.10.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="r-foundations.html"><a href="r-foundations.html#data-frames"><i class="fa fa-check"></i><b>1.11</b> Data Frames</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="r-foundations.html"><a href="r-foundations.html#creation-1"><i class="fa fa-check"></i><b>1.11.1</b> Creation</a></li>
<li class="chapter" data-level="1.11.2" data-path="r-foundations.html"><a href="r-foundations.html#extracting-parts-of-a-data-frame"><i class="fa fa-check"></i><b>1.11.2</b> Extracting parts of a data frame</a></li>
<li class="chapter" data-level="1.11.3" data-path="r-foundations.html"><a href="r-foundations.html#example-9"><i class="fa fa-check"></i><b>1.11.3</b> Example</a></li>
<li class="chapter" data-level="1.11.4" data-path="r-foundations.html"><a href="r-foundations.html#importing-data"><i class="fa fa-check"></i><b>1.11.4</b> Importing Data</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="r-foundations.html"><a href="r-foundations.html#logical-statements"><i class="fa fa-check"></i><b>1.12</b> Logical statements</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="r-foundations.html"><a href="r-foundations.html#basic-comparisons"><i class="fa fa-check"></i><b>1.12.1</b> Basic comparisons</a></li>
<li class="chapter" data-level="1.12.2" data-path="r-foundations.html"><a href="r-foundations.html#example-10"><i class="fa fa-check"></i><b>1.12.2</b> Example</a></li>
<li class="chapter" data-level="1.12.3" data-path="r-foundations.html"><a href="r-foundations.html#and-and-or-statements"><i class="fa fa-check"></i><b>1.12.3</b> And and Or statements</a></li>
<li class="chapter" data-level="1.12.4" data-path="r-foundations.html"><a href="r-foundations.html#example-11"><i class="fa fa-check"></i><b>1.12.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="r-foundations.html"><a href="r-foundations.html#subsetting-with-logical-statements"><i class="fa fa-check"></i><b>1.13</b> Subsetting with logical statements</a>
<ul>
<li class="chapter" data-level="1.13.1" data-path="r-foundations.html"><a href="r-foundations.html#example-12"><i class="fa fa-check"></i><b>1.13.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="r-foundations.html"><a href="r-foundations.html#ecosystem-debate"><i class="fa fa-check"></i><b>1.14</b> Ecosystem debate</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-exploration.html"><a href="data-exploration.html"><i class="fa fa-check"></i><b>2</b> Data exploration</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-exploration.html"><a href="data-exploration.html#data-analysis-process"><i class="fa fa-check"></i><b>2.1</b> Data analysis process</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-exploration.html"><a href="data-exploration.html#problem-formulation"><i class="fa fa-check"></i><b>2.1.1</b> Problem Formulation</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-exploration.html"><a href="data-exploration.html#data-collection"><i class="fa fa-check"></i><b>2.1.2</b> Data collection</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-exploration.html"><a href="data-exploration.html#data-exploration-1"><i class="fa fa-check"></i><b>2.2</b> Data exploration</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-exploration.html"><a href="data-exploration.html#numerical-summaries-of-data"><i class="fa fa-check"></i><b>2.2.1</b> Numerical summaries of data</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-exploration.html"><a href="data-exploration.html#visual-summaries-of-data"><i class="fa fa-check"></i><b>2.2.2</b> Visual summaries of data</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-exploration.html"><a href="data-exploration.html#what-to-look-for"><i class="fa fa-check"></i><b>2.2.3</b> What to look for</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-exploration.html"><a href="data-exploration.html#kidney-example"><i class="fa fa-check"></i><b>2.3</b> Kidney Example</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-exploration.html"><a href="data-exploration.html#numerically-summarizing-the-data"><i class="fa fa-check"></i><b>2.3.1</b> Numerically summarizing the data</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-exploration.html"><a href="data-exploration.html#cleaning-the-data"><i class="fa fa-check"></i><b>2.3.2</b> Cleaning the data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-exploration.html"><a href="data-exploration.html#visualizing-data-with-base-graphics"><i class="fa fa-check"></i><b>2.4</b> Visualizing data with <strong>base</strong> graphics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-exploration.html"><a href="data-exploration.html#histograms"><i class="fa fa-check"></i><b>2.4.1</b> Histograms</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-exploration.html"><a href="data-exploration.html#density-plots"><i class="fa fa-check"></i><b>2.4.2</b> Density plots</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-exploration.html"><a href="data-exploration.html#index-plots"><i class="fa fa-check"></i><b>2.4.3</b> Index plots</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-exploration.html"><a href="data-exploration.html#bivariate-scatter-plots"><i class="fa fa-check"></i><b>2.4.4</b> Bivariate scatter plots</a></li>
<li class="chapter" data-level="2.4.5" data-path="data-exploration.html"><a href="data-exploration.html#bivariate-boxplots"><i class="fa fa-check"></i><b>2.4.5</b> Bivariate boxplots</a></li>
<li class="chapter" data-level="2.4.6" data-path="data-exploration.html"><a href="data-exploration.html#multiple-plots-in-one-figure"><i class="fa fa-check"></i><b>2.4.6</b> Multiple plots in one figure</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-exploration.html"><a href="data-exploration.html#visualizing-data-with-ggplot2"><i class="fa fa-check"></i><b>2.5</b> Visualizing data with <strong>ggplot2</strong></a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-exploration.html"><a href="data-exploration.html#a-ggplot2-histogram"><i class="fa fa-check"></i><b>2.5.1</b> A <strong>ggplot2</strong> histogram</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-exploration.html"><a href="data-exploration.html#a-ggplot2-density-plot"><i class="fa fa-check"></i><b>2.5.2</b> A <strong>ggplot2</strong> density plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-exploration.html"><a href="data-exploration.html#a-ggplot2-scatter-plot"><i class="fa fa-check"></i><b>2.5.3</b> A <strong>ggplot2</strong> scatter plot</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-exploration.html"><a href="data-exploration.html#scaling-ggplot2-plots"><i class="fa fa-check"></i><b>2.5.4</b> Scaling <strong>ggplot2</strong> plots</a></li>
<li class="chapter" data-level="2.5.5" data-path="data-exploration.html"><a href="data-exploration.html#facetting-in-ggplot2"><i class="fa fa-check"></i><b>2.5.5</b> Facetting in <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.5.6" data-path="data-exploration.html"><a href="data-exploration.html#summary-of-ggplot2"><i class="fa fa-check"></i><b>2.5.6</b> Summary of <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="data-exploration.html"><a href="data-exploration.html#summary-of-data-exploration"><i class="fa fa-check"></i><b>2.6</b> Summary of data exploration</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html"><i class="fa fa-check"></i><b>3</b> Review of probability, random variables, and random vectors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#probability-basics"><i class="fa fa-check"></i><b>3.1</b> Probability Basics</a></li>
<li class="chapter" data-level="3.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#random-variables"><i class="fa fa-check"></i><b>3.2</b> Random Variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#discrete-random-variables"><i class="fa fa-check"></i><b>3.2.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#continuous-random-variables"><i class="fa fa-check"></i><b>3.2.2</b> Continuous random variables</a></li>
<li class="chapter" data-level="3.2.3" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#useful-facts-for-transformation-of-random-variables"><i class="fa fa-check"></i><b>3.2.3</b> Useful facts for transformation of random variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#multivariate-distributions"><i class="fa fa-check"></i><b>3.3</b> Multivariate distributions</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#basic-properties"><i class="fa fa-check"></i><b>3.3.1</b> Basic properties</a></li>
<li class="chapter" data-level="3.3.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#marginal-distributions"><i class="fa fa-check"></i><b>3.3.2</b> Marginal distributions</a></li>
<li class="chapter" data-level="3.3.3" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#independence-of-random-variables"><i class="fa fa-check"></i><b>3.3.3</b> Independence of random variables</a></li>
<li class="chapter" data-level="3.3.4" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#conditional-distributions"><i class="fa fa-check"></i><b>3.3.4</b> Conditional distributions</a></li>
<li class="chapter" data-level="3.3.5" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#covariance"><i class="fa fa-check"></i><b>3.3.5</b> Covariance</a></li>
<li class="chapter" data-level="3.3.6" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#useful-facts-for-transformations-of-multiple-random-variables"><i class="fa fa-check"></i><b>3.3.6</b> Useful facts for transformations of multiple random variables</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#random-vectors"><i class="fa fa-check"></i><b>3.4</b> Random vectors</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#definition"><i class="fa fa-check"></i><b>3.4.1</b> Definition</a></li>
<li class="chapter" data-level="3.4.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#mean-variance-and-covariance"><i class="fa fa-check"></i><b>3.4.2</b> Mean, variance, and covariance</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#properties-of-transformations-of-random-vectors"><i class="fa fa-check"></i><b>3.5</b> Properties of transformations of random vectors</a></li>
<li class="chapter" data-level="3.6" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#multivariate-normal-gaussian-distribution"><i class="fa fa-check"></i><b>3.6</b> Multivariate normal (Gaussian) distribution</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#definition-1"><i class="fa fa-check"></i><b>3.6.1</b> Definition</a></li>
<li class="chapter" data-level="3.6.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#useful-facts"><i class="fa fa-check"></i><b>3.6.2</b> Useful facts</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#example-1-1"><i class="fa fa-check"></i><b>3.7</b> Example 1</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#bernoulli-distribution"><i class="fa fa-check"></i><b>3.7.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="3.7.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#binomial-distribution"><i class="fa fa-check"></i><b>3.7.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="3.7.3" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#poisson-distribution"><i class="fa fa-check"></i><b>3.7.3</b> Poisson Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#example-2-1"><i class="fa fa-check"></i><b>3.8</b> Example 2</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-1"><i class="fa fa-check"></i><b>3.8.1</b> Problem 1</a></li>
<li class="chapter" data-level="3.8.2" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-2"><i class="fa fa-check"></i><b>3.8.2</b> Problem 2</a></li>
<li class="chapter" data-level="3.8.3" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-3"><i class="fa fa-check"></i><b>3.8.3</b> Problem 3</a></li>
<li class="chapter" data-level="3.8.4" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-4"><i class="fa fa-check"></i><b>3.8.4</b> Problem 4</a></li>
<li class="chapter" data-level="3.8.5" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-5"><i class="fa fa-check"></i><b>3.8.5</b> Problem 5</a></li>
<li class="chapter" data-level="3.8.6" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-6"><i class="fa fa-check"></i><b>3.8.6</b> Problem 6</a></li>
<li class="chapter" data-level="3.8.7" data-path="review-of-probability-random-variables-and-random-vectors.html"><a href="review-of-probability-random-variables-and-random-vectors.html#problem-7"><i class="fa fa-check"></i><b>3.8.7</b> Problem 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html"><i class="fa fa-check"></i><b>4</b> Useful matrix facts</a>
<ul>
<li class="chapter" data-level="4.1" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#notation"><i class="fa fa-check"></i><b>4.1</b> Notation</a></li>
<li class="chapter" data-level="4.2" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#basic-mathematical-properties"><i class="fa fa-check"></i><b>4.2</b> Basic mathematical properties</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#addition-and-subtraction"><i class="fa fa-check"></i><b>4.2.1</b> Addition and subtraction</a></li>
<li class="chapter" data-level="4.2.2" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#scalar-multiplication"><i class="fa fa-check"></i><b>4.2.2</b> Scalar multiplication</a></li>
<li class="chapter" data-level="4.2.3" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#matrix-multiplication"><i class="fa fa-check"></i><b>4.2.3</b> Matrix multiplication</a></li>
<li class="chapter" data-level="4.2.4" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#associative-property"><i class="fa fa-check"></i><b>4.2.4</b> Associative property</a></li>
<li class="chapter" data-level="4.2.5" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#distributive-property"><i class="fa fa-check"></i><b>4.2.5</b> Distributive property</a></li>
<li class="chapter" data-level="4.2.6" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#no-commutative-property"><i class="fa fa-check"></i><b>4.2.6</b> No commutative property</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#transpose-and-related-properties"><i class="fa fa-check"></i><b>4.3</b> Transpose and related properties</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#definition-2"><i class="fa fa-check"></i><b>4.3.1</b> Definition</a></li>
<li class="chapter" data-level="4.3.2" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#transpose-and-mathematical-operations"><i class="fa fa-check"></i><b>4.3.2</b> Transpose and mathematical operations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#special-matrices"><i class="fa fa-check"></i><b>4.4</b> Special matrices</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#square-matrices"><i class="fa fa-check"></i><b>4.4.1</b> Square matrices</a></li>
<li class="chapter" data-level="4.4.2" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#identity-matrix"><i class="fa fa-check"></i><b>4.4.2</b> Identity matrix</a></li>
<li class="chapter" data-level="4.4.3" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#symmetric"><i class="fa fa-check"></i><b>4.4.3</b> Symmetric</a></li>
<li class="chapter" data-level="4.4.4" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#idempotent"><i class="fa fa-check"></i><b>4.4.4</b> Idempotent</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#matrix-inverse"><i class="fa fa-check"></i><b>4.5</b> Matrix inverse</a></li>
<li class="chapter" data-level="4.6" data-path="useful-matrix-facts.html"><a href="useful-matrix-facts.html#matrix-derivatives"><i class="fa fa-check"></i><b>4.6</b> Matrix derivatives</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html"><i class="fa fa-check"></i><b>5</b> Linear model definition and properties</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#background-and-terminology"><i class="fa fa-check"></i><b>5.1</b> Background and terminology</a></li>
<li class="chapter" data-level="5.2" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#goals-of-regression"><i class="fa fa-check"></i><b>5.2</b> Goals of regression</a></li>
<li class="chapter" data-level="5.3" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#regression-for-pearsons-height-data"><i class="fa fa-check"></i><b>5.3</b> Regression for Pearson’s height data</a></li>
<li class="chapter" data-level="5.4" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>5.4</b> Definition of a linear model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#basic-construction-and-relationships"><i class="fa fa-check"></i><b>5.4.1</b> Basic construction and relationships</a></li>
<li class="chapter" data-level="5.4.2" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#as-a-system-of-equations"><i class="fa fa-check"></i><b>5.4.2</b> As a system of equations</a></li>
<li class="chapter" data-level="5.4.3" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#using-matrix-notation"><i class="fa fa-check"></i><b>5.4.3</b> Using matrix notation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#summarizing-the-components-of-a-linear-model"><i class="fa fa-check"></i><b>5.5</b> Summarizing the components of a linear model</a></li>
<li class="chapter" data-level="5.6" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#types-of-regression-models"><i class="fa fa-check"></i><b>5.6</b> Types of regression models</a></li>
<li class="chapter" data-level="5.7" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#standard-linear-model-assumptions-and-implications"><i class="fa fa-check"></i><b>5.7</b> Standard linear model assumptions and implications</a></li>
<li class="chapter" data-level="5.8" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#mathematical-interpretation-of-coefficients"><i class="fa fa-check"></i><b>5.8</b> Mathematical interpretation of coefficients</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#coefficient-interpretation-in-simple-linear-regression"><i class="fa fa-check"></i><b>5.8.1</b> Coefficient interpretation in simple linear regression</a></li>
<li class="chapter" data-level="5.8.2" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#coefficient-interpretation-in-multiple-linear-regression"><i class="fa fa-check"></i><b>5.8.2</b> Coefficient interpretation in multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="linear-model-definition-and-properties.html"><a href="linear-model-definition-and-properties.html#exercises"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html"><i class="fa fa-check"></i><b>6</b> Fitting a linear model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html#ols-estimation-of-the-simple-linear-regression-model"><i class="fa fa-check"></i><b>6.1</b> OLS estimation of the simple linear regression model</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html#ols-estimators-of-the-simple-linear-regression-coefficents"><i class="fa fa-check"></i><b>6.1.1</b> OLS estimators of the simple linear regression coefficents</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html#penguins-simple-linear-regression-example"><i class="fa fa-check"></i><b>6.2</b> Penguins simple linear regression example</a></li>
<li class="chapter" data-level="6.3" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html#fitting-a-linear-model-using-r"><i class="fa fa-check"></i><b>6.3</b> Fitting a linear model using R</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html#derivation-of-ols-simple-linear-regression-estimators"><i class="fa fa-check"></i><b>6.3.1</b> Derivation of OLS simple linear regression estimators</a></li>
<li class="chapter" data-level="6.3.2" data-path="fitting-a-linear-model.html"><a href="fitting-a-linear-model.html#expected-value-of-ols-simple-linear-regression-estimators"><i class="fa fa-check"></i><b>6.3.2</b> Expected value of OLS simple linear regression estimators</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interpreting-a-fitted-linear-model.html"><a href="interpreting-a-fitted-linear-model.html"><i class="fa fa-check"></i><b>7</b> Interpreting a fitted linear model</a></li>
<li class="chapter" data-level="8" data-path="categorical-predictors.html"><a href="categorical-predictors.html"><i class="fa fa-check"></i><b>8</b> Categorical predictors</a>
<ul>
<li class="chapter" data-level="8.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html#indicatordummy-variables"><i class="fa fa-check"></i><b>8.1</b> Indicator/dummy variables</a></li>
<li class="chapter" data-level="8.2" data-path="categorical-predictors.html"><a href="categorical-predictors.html#common-of-linear-models-with-categorical-predictors"><i class="fa fa-check"></i><b>8.2</b> Common of linear models with categorical predictors</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html#one-way-anova"><i class="fa fa-check"></i><b>8.2.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="8.2.2" data-path="categorical-predictors.html"><a href="categorical-predictors.html#main-effects-models"><i class="fa fa-check"></i><b>8.2.2</b> Main effects models</a></li>
<li class="chapter" data-level="8.2.3" data-path="categorical-predictors.html"><a href="categorical-predictors.html#interaction-models"><i class="fa fa-check"></i><b>8.2.3</b> Interaction models</a></li>
<li class="chapter" data-level="8.2.4" data-path="categorical-predictors.html"><a href="categorical-predictors.html#extensions"><i class="fa fa-check"></i><b>8.2.4</b> Extensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="assessing-and-addressing-collinearity.html"><a href="assessing-and-addressing-collinearity.html"><i class="fa fa-check"></i><b>9</b> Assessing and addressing collinearity</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Joshua French</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fitting-a-linear-model" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Fitting a linear model</h1>
<p>A linear model for a response variable <span class="math inline">\(Y\)</span> using <span class="math inline">\(p-1\)</span> predictor variables
<span class="math inline">\(X_1, \ldots, X_{p-1}\)</span> may be described by the formula</p>
<p><span class="math display">\[Y=\beta_0 + \beta_1 X_1 + \cdots + \beta_{p-1} X_{p-1} + \epsilon,\]</span>
where <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_{p-1}\)</span> are regression coefficients and <span class="math inline">\(\epsilon\)</span> is the error.</p>
<p>In this chapter we focus on estimating the regression coefficients.</p>
<p>Fitting a regression model is the same thing as estimating the parameters of a simple linear regression model.</p>
<p>There are many different methods of parameter estimation in statistics: method-of-moments, maximum likelihood, Bayesian, etc.</p>
<p>The most common estimation method for linear models is known as <strong>Ordinary Least Squares (OLS)</strong> estimation. OLS estimation estimates the parameters with the values that minimize the residuals sum of squares (RSS).</p>
<div id="ols-estimation-of-the-simple-linear-regression-model" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> OLS estimation of the simple linear regression model</h2>
<p>In a simple linear regression context, we have <span class="math inline">\(n\)</span> observed responses
<span class="math inline">\(Y_1,Y_2,\ldots,Y_n\)</span> and predictor values <span class="math inline">\(x_1,x_2,\ldots,x_n\)</span>.</p>
<p>Recall that in a simple linear regression model
<span class="math display">\[E(Y|X) = \beta_0 + \beta_1 X.\]</span>
We need to define some new notation and objects to define the RSS.</p>
<p>Let <span class="math inline">\(\beta_j\)</span> denote the estimated value of <span class="math inline">\(\beta_j\)</span> and the estimated mean response as a function of the predictor <span class="math inline">\(X\)</span> is <span class="math display">\[\hat{E}(Y|X) = \hat{\beta}_0 + \hat{\beta}_1 X.\]</span></p>
<p>The <strong><span class="math inline">\(i\)</span>th fitted value</strong> is defined as
<span class="math display">\[\hat{Y}_i = \hat{E}(Y_i|X = x_i) = \hat{\beta}_0 + \hat{\beta}_1 x_i.\]</span></p>
<p>The <strong><span class="math inline">\(i\)</span>th residual</strong> is defined as
<span class="math display">\[\hat{\epsilon}_i = Y_i - \hat{Y}_i.\]</span>
The RSS of a regression model is the sum of the squared residuals.</p>
<p>The RSS for a simple linear regression model, as a function of the estimated regression coefficients, is
<span class="math display">\[\begin{align}
RSS(\hat{\beta}_0, \hat{\beta}_1) &amp;= \sum_{i=1}^n \hat{\epsilon}_i^2 \\
&amp;= \sum_{i=1}^n (Y_i - \hat{Y}_i)^2 \\
&amp;= \sum_{i=1}^n (Y_i - \hat{E}(Y|X=x_i))^2 \\
 &amp;= \sum_{i=1}^n (Y_i - (\hat{\beta}_0 + \hat{\beta}_1 x_i))^2.
\end{align}\]</span></p>
<p>The <strong>fitted model</strong> is the estimated model that minimizes the RSS. In a simple linear regression context, the fitted model is known as the <strong>line of best fit</strong>.</p>
<p>In Figure <a href="fitting-a-linear-model.html#fig:rss-viz">6.1</a>, we attempt to visualize the response values, fitted values, residuals, and line of best fit in a simple linear regression context. Notice that:</p>
<ul>
<li>The fitted values are the value returned by the line of best fit when it is evaluated at the observed predictor values. Alternatively, the fitted value for each observation is the y-value obtained when intersecting the line of best fit with a vertical line drawn from each observed predictor value.</li>
<li>The residual is the vertical distance between each response value and the fitted value.</li>
<li>The RSS seeks to minimize the sum of the squared vertical distances between the response and fitted values.</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:rss-viz"></span>
<img src="Data-Analysis-with-Linear-Regression_files/figure-html/rss-viz-1.png" alt="Visualization of the response values, fitted values, residuals, and line of best fit." width="672" />
<p class="caption">
Figure 6.1: Visualization of the response values, fitted values, residuals, and line of best fit.
</p>
</div>
<div id="ols-estimators-of-the-simple-linear-regression-coefficents" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> OLS estimators of the simple linear regression coefficents</h3>
<p>Define <span class="math inline">\(\bar{x}=\sum_{i=1}^n x_i\)</span> and <span class="math inline">\(\bar{Y} = \sum_{i=1}^n Y_i\)</span>.</p>
<p>The OLS estimators of the regression coefficients for a simple linear regression coefficients are</p>
<p><span class="math display">\[\begin{align}
\hat{\beta}_1 &amp;= \frac{\sum_{i=1}^n x_i Y_i - \frac{1}{n} \biggl(\sum_{i=1}^n x_i\biggr)\biggl(\sum_{i=1}^n Y_i\biggr)}{\sum_{i=1}^n x_i^2 - \frac{1}{n} \biggl(\sum_{i=1}^n x_i\biggr)^2} \\
&amp;= \frac{\sum_{i=1}^n (x_i - \bar{x})(Y_i - \bar{Y})}{\sum_{i=1}^n (x_i - \bar{x})^2} \\
&amp;= \frac{\sum_{i=1}^n (x_i - \bar{x})Y_i}{\sum_{i=1}^n (x_i - \bar{x})x_i}
\end{align}\]</span>
and
<span class="math display">\[\begin{equation}
\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1 \bar{x}.
\end{equation}\]</span></p>
<p>Thought it’s already been said, we state once again that the OLS estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> shown above are the estimators that minimize the RSS.</p>
<p>The other parameter we’ve discussed is the error variance, <span class="math inline">\(\sigma^2\)</span>. The most common estimator of the error variance is
<span class="math display" id="eq:sigmasq-hat">\[\begin{equation}
\hat{\sigma}^2 = \frac{RSS}{n-p}, \tag{6.1}
\end{equation}\]</span>
where <span class="math inline">\(p\)</span> is the number of regression coefficients. In general, <span class="math inline">\(n-p\)</span> is the degrees of freedom of the RSS. In a simple linear regression context, the denominator of <a href="fitting-a-linear-model.html#eq:sigmasq-hat">(6.1)</a> is <span class="math inline">\(n-2\)</span>.</p>
</div>
</div>
<div id="penguins-simple-linear-regression-example" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Penguins simple linear regression example</h2>
<p>We will use the <code>penguins</code> data set in the <strong>palmerpenguins</strong> package <span class="citation">(<a href="#ref-R-palmerpenguins" role="doc-biblioref">Horst, Hill, and Gorman 2020</a>)</span> to illustrate a very basic simple linear regression analysis.</p>
<p>The <code>penguins</code> data set provides data related to various penguin species measured in the Palmer Archipelago (Antarctica), originally provided by <span class="citation"><a href="#ref-GormanEtAl2014" role="doc-biblioref">Gorman, Williams, and Fraser</a> (<a href="#ref-GormanEtAl2014" role="doc-biblioref">2014</a>)</span>. We start by loading the data into memory.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="fitting-a-linear-model.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(penguins, <span class="at">package =</span> <span class="st">&quot;palmerpenguins&quot;</span>)</span></code></pre></div>
<p>The data set includes 344 observations of 8 variables. The variables are:</p>
<ul>
<li><code>species</code>: a <code>factor</code> indicating the penguin species</li>
<li><code>island</code>: a <code>factor</code> indicating the island the penguin was observed</li>
<li><code>bill_length_mm</code>: a <code>numeric</code> variable indicating the bill length in millimeters</li>
<li><code>bill_depth_mm</code>: a <code>numeric</code> variable indicating the bill depth in millimeters</li>
<li><code>flipper_length_mm</code>: an <code>integer</code> variable indicating the flipper length in millimeters</li>
<li><code>body_mass_g</code>: an <code>integer</code> variable indicating the body mass in grams</li>
<li><code>sex</code>: a <code>factor</code> indicating the penguin sex (<code>female</code>, <code>male</code>)</li>
<li><code>year</code>: an integer denoting the study year the penguin was observed (<code>2007</code>, <code>2008</code>, or <code>2009</code>)</li>
</ul>
<p>We begin by creating a scatter plot of <code>bill_length_mm</code> versus <code>body_mass_g</code> (y-axis versus x-axis) in Figure <a href="fitting-a-linear-model.html#fig:penguin-plot">6.2</a>. We see a clear positive association between body mass and bill length: as the body mass increases, the bill length tends to increase. The pattern is linear, i.e., roughly a straight line.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="fitting-a-linear-model.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bill_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins,</span>
<span id="cb50-2"><a href="fitting-a-linear-model.html#cb50-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;bill length (mm)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;body mass (g)&quot;</span>,</span>
<span id="cb50-3"><a href="fitting-a-linear-model.html#cb50-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Penguin size measurements&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:penguin-plot"></span>
<img src="Data-Analysis-with-Linear-Regression_files/figure-html/penguin-plot-1.png" alt="A scatter plot of penguin bill length (mm) versus body mass (g)" width="672" />
<p class="caption">
Figure 6.2: A scatter plot of penguin bill length (mm) versus body mass (g)
</p>
</div>
<p>We first perform a single linear regression analysis manually using the equations previously provided by regressing <code>bill_length_mm</code> on <code>body_mass_g</code>.</p>
<p>Using the <code>summary</code> function on the <code>penguins</code> data frame, we see that both <code>bill_length_mm</code> and <code>body_mass_g</code> have <code>NA</code> values.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="fitting-a-linear-model.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(penguins)</span>
<span id="cb51-2"><a href="fitting-a-linear-model.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       species          island    bill_length_mm  bill_depth_mm  </span></span>
<span id="cb51-3"><a href="fitting-a-linear-model.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10  </span></span>
<span id="cb51-4"><a href="fitting-a-linear-model.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60  </span></span>
<span id="cb51-5"><a href="fitting-a-linear-model.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30  </span></span>
<span id="cb51-6"><a href="fitting-a-linear-model.html#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  Mean   :43.92   Mean   :17.15  </span></span>
<span id="cb51-7"><a href="fitting-a-linear-model.html#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  3rd Qu.:48.50   3rd Qu.:18.70  </span></span>
<span id="cb51-8"><a href="fitting-a-linear-model.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  Max.   :59.60   Max.   :21.50  </span></span>
<span id="cb51-9"><a href="fitting-a-linear-model.html#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                  NA&#39;s   :2       NA&#39;s   :2      </span></span>
<span id="cb51-10"><a href="fitting-a-linear-model.html#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  flipper_length_mm  body_mass_g       sex           year     </span></span>
<span id="cb51-11"><a href="fitting-a-linear-model.html#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :172.0     Min.   :2700   female:165   Min.   :2007  </span></span>
<span id="cb51-12"><a href="fitting-a-linear-model.html#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007  </span></span>
<span id="cb51-13"><a href="fitting-a-linear-model.html#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :197.0     Median :4050   NA&#39;s  : 11   Median :2008  </span></span>
<span id="cb51-14"><a href="fitting-a-linear-model.html#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :200.9     Mean   :4202                Mean   :2008  </span></span>
<span id="cb51-15"><a href="fitting-a-linear-model.html#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009  </span></span>
<span id="cb51-16"><a href="fitting-a-linear-model.html#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :231.0     Max.   :6300                Max.   :2009  </span></span>
<span id="cb51-17"><a href="fitting-a-linear-model.html#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  NA&#39;s   :2         NA&#39;s   :2</span></span></code></pre></div>
<p>We want to remove the rows of <code>penguins</code> where either <code>body_mass_g</code> or <code>bill_length_mm</code> have <code>NA</code> values. We do that below using the <code>na.omit</code> function (selecting only the relevant variables) and assign the cleaned object the name <code>penguins_clean</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="fitting-a-linear-model.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove rows of penguins where bill_length_mm or body_mass_g have NA values </span></span>
<span id="cb52-2"><a href="fitting-a-linear-model.html#cb52-2" aria-hidden="true" tabindex="-1"></a>penguins_clean <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(penguins[,<span class="fu">c</span>(<span class="st">&quot;bill_length_mm&quot;</span>, <span class="st">&quot;body_mass_g&quot;</span>)])</span></code></pre></div>
<p>We extract the <code>bill_length_mm</code> variable from the <code>penguins</code> data frame and assign it the name <code>y</code> since it will be the response variable. We extract the <code>body_mass_g</code> variable from the <code>penguins</code> data frame and assign it the name <code>y</code> since it will be the predictor variable. We also determine the number of observations and assign that value the name <code>n</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="fitting-a-linear-model.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract response and predictor from penguins_clean</span></span>
<span id="cb53-2"><a href="fitting-a-linear-model.html#cb53-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> penguins_clean<span class="sc">$</span>bill_length_mm</span>
<span id="cb53-3"><a href="fitting-a-linear-model.html#cb53-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> penguins_clean<span class="sc">$</span>body_mass_g</span>
<span id="cb53-4"><a href="fitting-a-linear-model.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># determine number of observations</span></span>
<span id="cb53-5"><a href="fitting-a-linear-model.html#cb53-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span></code></pre></div>
<p>We now compute <span class="math inline">\(\hat{\beta}\)</span>_1 and <span class="math inline">\(\hat{beta}_0\)</span>. Note that placing <code>()</code> around the assignment operations will both perform the assign and print the results.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="fitting-a-linear-model.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute OLS estimates of beta1 and beta0</span></span>
<span id="cb54-2"><a href="fitting-a-linear-model.html#cb54-2" aria-hidden="true" tabindex="-1"></a>(b1 <span class="ot">&lt;-</span> (<span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="sc">-</span> <span class="fu">sum</span>(x) <span class="sc">*</span> <span class="fu">sum</span>(y) <span class="sc">/</span> n)<span class="sc">/</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">sum</span>(x)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n))</span>
<span id="cb54-3"><a href="fitting-a-linear-model.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.004051417</span></span>
<span id="cb54-4"><a href="fitting-a-linear-model.html#cb54-4" aria-hidden="true" tabindex="-1"></a>(b0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> b1 <span class="sc">*</span> <span class="fu">mean</span>(x))        </span>
<span id="cb54-5"><a href="fitting-a-linear-model.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 26.89887</span></span></code></pre></div>
<p>The estimated value of <span class="math inline">\(\beta_0\)</span> is <span class="math inline">\(\hat{\beta}_1-22.02\)</span> and the estimate value of <span class="math inline">\(\beta_1\)</span> is <span class="math inline">\(\hat{\beta}_1=-0.0011\)</span>.</p>
<p>We can use the <code>abline</code> function to overlay the fitted model on the observed data. Note that in simple linear regression, <span class="math inline">\(\hat{\beta}_1\)</span> corresponds to the slope of the fitted line and <span class="math inline">\(\hat{\beta}_0\)</span> will be the intercept.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="fitting-a-linear-model.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bill_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins,</span>
<span id="cb55-2"><a href="fitting-a-linear-model.html#cb55-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;bill length (mm)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;body mass (g)&quot;</span>,</span>
<span id="cb55-3"><a href="fitting-a-linear-model.html#cb55-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Penguin size measurements&quot;</span>)</span>
<span id="cb55-4"><a href="fitting-a-linear-model.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># a is the intercept and b is the slope</span></span>
<span id="cb55-5"><a href="fitting-a-linear-model.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> b0, <span class="at">b =</span> b1)</span></code></pre></div>
<p><img src="Data-Analysis-with-Linear-Regression_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>The fit of the model to our data seems reasonable.</p>
<p>We can also compute the residuals, <span class="math inline">\(\hat{\epsilon}_1,\ldots,\hat{\epsilon}_n\)</span>, the fitted values <span class="math inline">\(\hat{y}_1,\ldots,\hat{y}_n\)</span>, and the associated RSS, <span class="math inline">\(RSS=\sum_{i=1}^n \hat{\epsilon}_i^2\)</span>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="fitting-a-linear-model.html#cb56-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x <span class="co"># compute fitted values</span></span>
<span id="cb56-2"><a href="fitting-a-linear-model.html#cb56-2" aria-hidden="true" tabindex="-1"></a>ehat <span class="ot">&lt;-</span> y <span class="sc">-</span> yhat <span class="co"># compute residuals</span></span>
<span id="cb56-3"><a href="fitting-a-linear-model.html#cb56-3" aria-hidden="true" tabindex="-1"></a>(rss <span class="ot">&lt;-</span> <span class="fu">sum</span>(ehat<span class="sc">^</span><span class="dv">2</span>)) <span class="co"># sum of the squared residuals</span></span>
<span id="cb56-4"><a href="fitting-a-linear-model.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 6564.494</span></span>
<span id="cb56-5"><a href="fitting-a-linear-model.html#cb56-5" aria-hidden="true" tabindex="-1"></a>(sigmasqhat <span class="ot">&lt;-</span> rss<span class="sc">/</span>(n<span class="dv">-2</span>)) <span class="co"># estimated error variance</span></span>
<span id="cb56-6"><a href="fitting-a-linear-model.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 19.30734</span></span></code></pre></div>
</div>
<div id="fitting-a-linear-model-using-r" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Fitting a linear model using R</h2>
<p>We now describe how to use R to fit a linear model to data.</p>
<p>The <code>lm</code> function uses OLS to fit a linear model to data. The function has two major arguments:</p>
<ul>
<li><code>data</code>: the data frame in which the model variables are stored. This can be omitted if the variables are already stored in memory.</li>
<li><code>formula</code>: a @(wilkinsonrogers1973) style formula describing the linear regression model. Assuming the <code>y</code> is the response, <code>x</code>, <code>x1</code>, <code>x2</code>, <code>x3</code> are available predictors:
<ul>
<li><code>y ~ x</code> describes a simple linear regression model based on <span class="math inline">\(E(Y|X)=\beta_0+\beta_1 X\)</span>.</li>
<li><code>y ~ x1 + x2</code> describes a multiple linear regression model based on <span class="math inline">\(E(Y|X_1, X_2)=\beta_0+\beta_1 X_1 + \beta_2 X_2\)</span>.</li>
<li><code>y ~ x1 + x2 + x1:x2</code> and <code>y ~ x1 * x2</code> describe a multiple linear regression model based on <span class="math inline">\(E(Y|X_1, X_2)=\beta_0+\beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3\)</span>.</li>
<li><code>y ~ -1 + x1 + x2</code> describes a multiple linear regression model without an intercept, in this case, <span class="math inline">\(E(Y|X_1, X_2)=\beta_1 X_1 + \beta_2 X_2\)</span>.</li>
</ul></li>
</ul>
<p>We fit a linear model regressing <code>body_mass_g</code> on <code>bill_length_mm</code> using the <code>penguins</code> data frame and store it in the object <code>lmod</code>. <code>lmod</code> is an object of class <code>lm</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="fitting-a-linear-model.html#cb57-1" aria-hidden="true" tabindex="-1"></a>lmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(bill_length_mm <span class="sc">~</span> body_mass_g, <span class="at">data =</span> penguins) <span class="co"># fit model</span></span>
<span id="cb57-2"><a href="fitting-a-linear-model.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(lmod) <span class="co"># class of lmod</span></span>
<span id="cb57-3"><a href="fitting-a-linear-model.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;lm&quot;</span></span></code></pre></div>
<p>There are a number of methods (generic function that do something specific when applied to a certain type of object). Commonly used ones include:</p>
<ul>
<li><code>residuals</code>: extracts <span class="math inline">\(\hat{\boldsymbol{\epsilon}}\)</span> from an <code>lm</code> object.</li>
<li><code>fitted</code>: extracts <span class="math inline">\(\hat{\mathbf{y}}\)</span> from an <code>lm</code> object.</li>
<li><code>coef</code> or <code>coefficients</code>: extracts <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> from an <code>lm</code> object.</li>
<li><code>deviance</code>: extracts the RSS from an <code>lm</code> object.</li>
<li><code>sigma</code>: extracts <span class="math inline">\(\hat{\sigma}\)</span> from an <code>lm</code> object.</li>
<li><code>df.residual</code>: extracts <span class="math inline">\(n-p\)</span>, the degrees of freedom for the RSS, from an <code>lm</code> object.</li>
<li><code>summary</code>: provides:
<ul>
<li>A 5-number summary of the <span class="math inline">\(\hat{\boldsymbol{\epsilon}}\)</span></li>
<li>A table that lists the predictors, the <code>Estimate</code> of the associated coefficients, the <strong>estimated</strong> standard error of the estimates (<code>Std.Error</code>), the computed test statistic associated with testing <span class="math inline">\(H_0: \beta_j = 0\)</span> versus <span class="math inline">\(H_a: \beta_j \neq 0\)</span> for <span class="math inline">\(j=0,1,\ldots,p-1\)</span> (<code>t value</code>), and the associated p-value of each test <code>Pr(&gt;|t|)</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="fitting-a-linear-model.html#cb58-1" aria-hidden="true" tabindex="-1"></a>(coeffs2 <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(lmod)) <span class="co"># extract, assign, and print coefficients</span></span>
<span id="cb58-2"><a href="fitting-a-linear-model.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (Intercept)  body_mass_g </span></span>
<span id="cb58-3"><a href="fitting-a-linear-model.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26.898872424  0.004051417</span></span>
<span id="cb58-4"><a href="fitting-a-linear-model.html#cb58-4" aria-hidden="true" tabindex="-1"></a>ehat2 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lmod) <span class="co"># extract and assign residuals</span></span>
<span id="cb58-5"><a href="fitting-a-linear-model.html#cb58-5" aria-hidden="true" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> <span class="fu">fitted</span>(lmod) <span class="co"># extract and assign fitted values</span></span>
<span id="cb58-6"><a href="fitting-a-linear-model.html#cb58-6" aria-hidden="true" tabindex="-1"></a>rss2 <span class="ot">&lt;-</span> <span class="fu">deviance</span>(lmod) <span class="co"># extract and assign rss</span></span>
<span id="cb58-7"><a href="fitting-a-linear-model.html#cb58-7" aria-hidden="true" tabindex="-1"></a>sigmasqhat2 <span class="ot">&lt;-</span> rss2<span class="sc">/</span><span class="fu">df.residual</span>(lmod) <span class="co"># estimated error variance</span></span>
<span id="cb58-8"><a href="fitting-a-linear-model.html#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to manually computed values</span></span>
<span id="cb58-9"><a href="fitting-a-linear-model.html#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">c</span>(b0, b1), coeffs2, <span class="at">check.attributes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-10"><a href="fitting-a-linear-model.html#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb58-11"><a href="fitting-a-linear-model.html#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(ehat, ehat2, <span class="at">check.attributes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-12"><a href="fitting-a-linear-model.html#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb58-13"><a href="fitting-a-linear-model.html#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(rss, rss2)</span>
<span id="cb58-14"><a href="fitting-a-linear-model.html#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb58-15"><a href="fitting-a-linear-model.html#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(sigmasqhat, sigmasqhat2)</span>
<span id="cb58-16"><a href="fitting-a-linear-model.html#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb58-17"><a href="fitting-a-linear-model.html#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co"># methods(class=&quot;lm&quot;)</span></span></code></pre></div>
<div id="derivation-of-ols-simple-linear-regression-estimators" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Derivation of OLS simple linear regression estimators</h3>
<p>Use calculus to derive the OLS estimator of the regression coefficients. Take the partial derivatives of <span class="math inline">\(RSS(\hat{\beta}_0, \hat{\beta}_1)\)</span> with respect to
<span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>, set the derivatives equal to zero, and solve for <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> to find the critical points of <span class="math inline">\(RSS(\hat{\beta}_0, \hat{\beta}_1)\)</span>. Technically, you must show that the Hessian matrix of <span class="math inline">\(RSS(\hat{\beta}_0, \hat{\beta}_1)\)</span> is positive definite to verify that our solution minimizes the RSS, but we won’t do that here.</p>
<p><span class="math display">\[\\[4in]\]</span></p>
</div>
<div id="expected-value-of-ols-simple-linear-regression-estimators" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Expected value of OLS simple linear regression estimators</h3>
<p>Determine the expected value of the OLS simple linear regression estimators.</p>
<p><span class="math display">\[\\[4in]\]</span></p>
<!-- ## Simple Linear Regression -->
<!-- ### Model description -->
<!-- The simple linear regression model is described by the mean function  -->
<!-- $$E(Y│X=x)=\beta_0+\beta_1 x,$$ -->
<!-- and variance function -->
<!-- $$var(Y│X=x)=\sigma^2,$$ -->
<!-- where: -->
<!-- * $Y$ is the response variable -->
<!-- * $X$ is a regressor variable -->
<!-- * $\beta_0$ and $\beta_1$ are known as *regression parameters* or *regression coefficients*. -->
<!-- Note:  -->
<!-- * The values that $Y$ takes are modeled as random variables. -->
<!-- * The values that $X$ takes are modeled as known, non-random values. -->
<!-- ### Interpreting the regression coefficients -->
<!-- * The *intercept*, $\beta_0$, is the mean response when $X=0$. -->
<!--   * i.e., $\beta_0=E(Y|X=0)$. -->
<!-- * The *slope*, $\beta_1$, is the mean change in the response when $X$ increases by 1 unit. -->
<!--   * i.e., $\beta_1 = E(Y|X=x+1)-E(Y|X=x)$. -->
<!-- ```{r} -->
<!-- plot(c(-1, 3), c(-1, 3), type = "n", xlab = expression(italic(X)), ylab = expression(italic(Y)), asp = 1) -->
<!-- abline(a = 1, b = 1) -->
<!-- lines(c(0, 0.25), c(0, 0)) -->
<!-- lines(c(0, 0.25), c(1, 1)) -->
<!-- lines(c(0.25, 0.25), c(0, 1)) -->
<!-- lines(c(0.25, 0.5), c(0.5, 0.5)) -->
<!-- text(0.5, 0.5, expression(italic(beta)[0]), pos = 4) -->
<!-- lines(c(1, 2), c(2, 2)) -->
<!-- lines(c(2, 2), c(2, 3)) -->
<!-- lines(c(2, 2.25), c(2.5, 2.5)) -->
<!-- text(2.25, 2.5, expression(italic(beta)[1]), pos = 4) -->
<!-- ``` -->
<!-- #  -->
<!-- # ## Simple Linear Regression -->
<!-- #  -->
<!-- # The simple linear regression model consists of the mean function  -->
<!-- # $$E(Y│X=x)=\beta_0+\beta_1 x,$$ -->
<!-- # and variance function -->
<!-- #  -->
<!-- # $$var(Y│X=x)=\sigma^2,$$ -->
<!-- # where: -->
<!-- #  -->
<!-- # - $Y$ is the response -->
<!-- # - $X$ is a regressor variable -->
<!-- # - $\beta_0$ and $\beta_1$ are known as **regression parameters** or **coefficients**. -->
<!-- #  -->
<!-- # # Simple Linear Regression -->
<!-- #  -->
<!-- # Chapter 2 of LMWR2, Chapter 2 and 3 of ALR4 -->
<!-- #  -->
<!-- #  -->
<!-- # ## Simple Linear Regression -->
<!-- #  -->
<!-- # The simple linear regression model consists of the mean function  -->
<!-- # $$E(Y│X=x)=\beta_0+\beta_1 x,$$ -->
<!-- #  -->
<!-- # and variance function -->
<!-- #  -->
<!-- # $$var(Y│X=x)=\sigma^2,$$ -->
<!-- # where: -->
<!-- #  -->
<!-- # - $Y$ is the response -->
<!-- # - $X$ is a regressor variable -->
<!-- # - $\beta_0$ and $\beta_1$ are known as **regression parameters** or **coefficients**. -->
<!-- #  -->
<!-- # ## Understanding the model -->
<!-- # ```{r} -->
<!-- # set.seed(1) -->
<!-- # x = runif(10, 60, 100) -->
<!-- # y = x + rnorm(10) -->
<!-- # plot(x,y, pch=20, xlab = 'Midyear Evaluation', ylab = 'Year-End Evaluation', main = 'Y = -0.74 +1.01 X') -->
<!-- # abline(lm(y~x), lwd = 2, col = 'red') -->
<!-- # ``` -->
<!-- #  -->
<!-- #  -->
<!-- # ## Understanding the model  -->
<!-- # ```{r out.width='1000px'} -->
<!-- # library(knitr) -->
<!-- # include_graphics('images/simple_lin_reg.png') -->
<!-- # ``` -->
<!-- #  -->
<!-- # ## Understand Coefficients -->
<!-- #  -->
<!-- # ```{r} -->
<!-- # include_graphics('images/coefficients.png', dpi=80) -->
<!-- # ``` -->
<!-- #  -->
<!-- # ## View from single observation -->
<!-- # Assume that we have n observations or cases for which the response and predictor variables are measured. -->
<!-- #  -->
<!-- # -    The responses are denoted $y_1,y_2,\dots ,y_n$. -->
<!-- # -    The regressor values for regressor X are denoted $x_1,x_2,\dots,x_n$. -->
<!-- #  -->
<!-- # Each response will deviate from its associated mean, so our statistical model must include an additional source of variation. -->
<!-- #  -->
<!-- # The statistical model for each response is -->
<!-- # $$y_i=\beta_0+\beta_1 x_i+\epsilon_i,\quad   i=1,2,\dots,n,$$ -->
<!-- #  -->
<!-- # where $\epsilon_i$ denotes the deviation of $y_i$ from its mean. -->
<!-- #  -->
<!-- # -    The $\epsilon_i$ are known as errors. -->
<!-- #  -->
<!-- # ## Conditions on Error -->
<!-- #  -->
<!-- # Conditional on knowing the regressor values, the errors have:  -->
<!-- #  -->
<!-- # -    Mean 0 -->
<!-- # -    Variance $\sigma^2$ (constant) -->
<!-- # -    And are uncorrelated. -->
<!-- #  -->
<!-- # Mathematically, this is the same as:  -->
<!-- #  -->
<!-- # -    $E(\epsilon_i│X=x_i )=0$  -->
<!-- # -    $var(\epsilon_i│X=x_i )=\sigma^2$ -->
<!-- # -    $cov(\epsilon_i,\epsilon_j )=0$  when $i\neq j$. -->
<!-- #  -->
<!-- # ## What about the response? -->
<!-- #  -->
<!-- # - Mean: -->
<!-- #  -->
<!-- #   $$E[Y_i|X_i] = E[\beta_0+\beta_1X_i + \epsilon_i]= \beta_0 + \beta_1X_i$$ -->
<!-- #   $$Var(Y_i|X_i) = Var(\beta_0+\beta_1X_i + \epsilon_i) = Var(\epsilon_i) = \sigma^2$$ -->
<!-- #   $$cov(Y_i, Y_j) = 0,\quad i \neq j$$ -->
<!-- #   The responses $Y_i$ come from probability distributions whose means are $\beta_0+\beta_1X_i$ and whose variances are $\sigma^2$, the same for all levels of $X$. Further, any two responses $Y_i$ and $Y_j$ are uncorrelated.  -->
<!-- #    -->
<!-- # ## Example -->
<!-- #  -->
<!-- # ```{r} -->
<!-- # include_graphics('images/simple_lin_reg_values.png',dpi = 100) -->
<!-- # ``` -->

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-GormanEtAl2014" class="csl-entry">
Gorman, Kristen B., Tony D. Williams, and William R. Fraser. 2014. <span>“Ecological Sexual Dimorphism and Environmental Variability Within a Community of Antarctic Penguins (Genus Pygoscelis).”</span> <em>PLOS ONE</em> 9 (3): 1–14. <a href="https://doi.org/10.1371/journal.pone.0090081">https://doi.org/10.1371/journal.pone.0090081</a>.
</div>
<div id="ref-R-palmerpenguins" class="csl-entry">
Horst, Allison, Alison Hill, and Kristen Gorman. 2020. <em>Palmerpenguins: Palmer Archipelago (Antarctica) Penguin Data</em>. <a href="https://CRAN.R-project.org/package=palmerpenguins">https://CRAN.R-project.org/package=palmerpenguins</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-model-definition-and-properties.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interpreting-a-fitted-linear-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data-Analysis-with-Linear-Regression.pdf", "Data-Analysis-with-Linear-Regression.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
